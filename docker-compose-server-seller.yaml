version: '3'

services:
  server-seller1:
    image: adarshzededa/server-seller:latest
    platform: "linux/amd64"
    build:
      dockerfile: ./Dockerfile-server
    restart: always
    environment:
      SERVER_HOST: 0.0.0.0
      SERVER_PORT: 50001
      TRANSACTION_HOST: transaction-service
      TRANSACTION_PORT: 50004
      NODE_NAME: server-seller1
      NOSQL_NODE_NAMES: product-db1,product-db2,product-db3,product-db4,product-db5
      NOSQL_NODE_PORTS: 50001,50002,50003,50004,50005
      SQL_NODE_NAMES: customer-db1,customer-db2,customer-db3,customer-db4,customer-db5
      SQL_NODE_PORTS: 50001,50002,50003,50004,50005
    extra_hosts:
      - "customer-db1:10.10.1.1"
      - "customer-db2:10.10.1.1"
      - "customer-db3:10.10.1.1"
      - "customer-db4:10.10.1.1"
      - "customer-db5:10.10.1.1"
      - "product-db1:10.10.1.2"
      - "product-db2:10.10.1.2"
      - "product-db3:10.10.1.2"
      - "product-db4:10.10.1.2"
      - "product-db5:10.10.1.2"
      - "transaction-service:10.10.1.3"
    network_mode: "host"


  server-seller2:
    image: adarshzededa/server-seller:latest
    platform: "linux/amd64"
    build:
      dockerfile: ./Dockerfile-server
    restart: always
    environment:
      SERVER_HOST: 0.0.0.0
      SERVER_PORT: 50002
      TRANSACTION_HOST: transaction-service
      TRANSACTION_PORT: 50004
      NODE_NAME: server-seller2
      NOSQL_NODE_NAMES: product-db1,product-db2,product-db3,product-db4,product-db5
      NOSQL_NODE_PORTS: 50001,50002,50003,50004,50005
      SQL_NODE_NAMES: customer-db1,customer-db2,customer-db3,customer-db4,customer-db5
      SQL_NODE_PORTS: 50001,50002,50003,50004,50005
    extra_hosts:
      - "customer-db1:10.10.1.1"
      - "customer-db2:10.10.1.1"
      - "customer-db3:10.10.1.1"
      - "customer-db4:10.10.1.1"
      - "customer-db5:10.10.1.1"
      - "product-db1:10.10.1.2"
      - "product-db2:10.10.1.2"
      - "product-db3:10.10.1.2"
      - "product-db4:10.10.1.2"
      - "product-db5:10.10.1.2"
      - "transaction-service:10.10.1.3"
    network_mode: "host"

  server-seller3:
    image: adarshzededa/server-seller:latest
    platform: "linux/amd64"
    build:
      dockerfile: ./Dockerfile-server
    restart: always
    environment:
      SERVER_HOST: 0.0.0.0
      SERVER_PORT: 50003
      TRANSACTION_HOST: transaction-service
      TRANSACTION_PORT: 50004
      NODE_NAME: server-seller3
      NOSQL_NODE_NAMES: product-db1,product-db2,product-db3,product-db4,product-db5
      NOSQL_NODE_PORTS: 50001,50002,50003,50004,50005
      SQL_NODE_NAMES: customer-db1,customer-db2,customer-db3,customer-db4,customer-db5
      SQL_NODE_PORTS: 50001,50002,50003,50004,50005
    extra_hosts:
      - "customer-db1:10.10.1.1"
      - "customer-db2:10.10.1.1"
      - "customer-db3:10.10.1.1"
      - "customer-db4:10.10.1.1"
      - "customer-db5:10.10.1.1"
      - "product-db1:10.10.1.2"
      - "product-db2:10.10.1.2"
      - "product-db3:10.10.1.2"
      - "product-db4:10.10.1.2"
      - "product-db5:10.10.1.2"
      - "transaction-service:10.10.1.3"
    network_mode: "host"

  server-seller4:
    image: adarshzededa/server-seller:latest
    platform: "linux/amd64"
    build:
      dockerfile: ./Dockerfile-server
    restart: always
    environment:
      SERVER_HOST: 0.0.0.0
      SERVER_PORT: 50004
      TRANSACTION_HOST: transaction-service
      TRANSACTION_PORT: 50004
      NODE_NAME: server-seller4
      NOSQL_NODE_NAMES: product-db1,product-db2,product-db3,product-db4,product-db5
      NOSQL_NODE_PORTS: 50001,50002,50003,50004,50005
      SQL_NODE_NAMES: customer-db1,customer-db2,customer-db3,customer-db4,customer-db5
      SQL_NODE_PORTS: 50001,50002,50003,50004,50005
    extra_hosts:
      - "customer-db1:10.10.1.1"
      - "customer-db2:10.10.1.1"
      - "customer-db3:10.10.1.1"
      - "customer-db4:10.10.1.1"
      - "customer-db5:10.10.1.1"
      - "product-db1:10.10.1.2"
      - "product-db2:10.10.1.2"
      - "product-db3:10.10.1.2"
      - "product-db4:10.10.1.2"
      - "product-db5:10.10.1.2"
      - "transaction-service:10.10.1.3"
    network_mode: "host"
